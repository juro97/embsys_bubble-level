<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bubble Level: nucleo-l432kc_9dof-imu-click/Core/Inc/mpu9dof.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Bubble Level
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c60c5f541fe417ea2feca524824005cb.html">nucleo-l432kc_9dof-imu-click</a></li><li class="navelem"><a class="el" href="dir_7da1bb9ed278c7805e71feff8d6f14f7.html">Core</a></li><li class="navelem"><a class="el" href="dir_2ecf5a6776809399cf3e323a5f2f5ba9.html">Inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mpu9dof.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="nucleo-l432kc__9dof-imu-click_2_core_2_inc_2main_8h_source.html">main.h</a>&quot;</code><br />
</div>
<p><a href="mpu9dof_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a949f4308c28a7a773584c8e6c281e3cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a949f4308c28a7a773584c8e6c281e3cb">mpu9dof_default_cfg</a> ()</td></tr>
<tr class="memdesc:a949f4308c28a7a773584c8e6c281e3cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">:  <a href="mpu9dof_8h.html#a949f4308c28a7a773584c8e6c281e3cb">More...</a><br /></td></tr>
<tr class="separator:a949f4308c28a7a773584c8e6c281e3cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc02bdc34e18dabb24af73d49310a0df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#abc02bdc34e18dabb24af73d49310a0df">mpu9dof_read</a> (const uint8_t *sensor)</td></tr>
<tr class="memdesc:abc02bdc34e18dabb24af73d49310a0df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read sensor data from MPU9DOF module.  <a href="mpu9dof_8h.html#abc02bdc34e18dabb24af73d49310a0df">More...</a><br /></td></tr>
<tr class="separator:abc02bdc34e18dabb24af73d49310a0df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9142720b7540c091b60f8994f33e6ec2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a9142720b7540c091b60f8994f33e6ec2">calibrateRawValues</a> ()</td></tr>
<tr class="separator:a9142720b7540c091b60f8994f33e6ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad71d9c59c88e17c72bf8b6e9fd4b9c41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#ad71d9c59c88e17c72bf8b6e9fd4b9c41">mpu9dof_calibrate_module</a> (void)</td></tr>
<tr class="memdesc:ad71d9c59c88e17c72bf8b6e9fd4b9c41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrates the 9DOF MPU module by calculating the value of the sample data. This function performs calibration for the 9DOF MPU module. The calibration process is performed by reading gyro data using the <a class="el" href="mpu9dof_8c.html#abc02bdc34e18dabb24af73d49310a0df" title="Read sensor data from MPU9DOF module.">mpu9dof_read()</a> function with the sensor type set to GYRO. The sample data is accumulated in the gyro_sum array. After collecting the required number of samples defined by CALIBRATION_SAMPLES, the mean value is calculated for each gyro axis. The gyro offset values are stored in the offsetValues.gyro_offset array, and the calibrated gyro data is stored in the calibratedData.gyro_calib array. Additionally, a normal 1G offset of the accelerometer in the Z-axis is accounted for by subtracting 16384 from the offsetValues.acc_offset[2] value. The calibrated accelerometer data is stored in the calibratedData.acc_calib[2] variable.  <a href="mpu9dof_8h.html#ad71d9c59c88e17c72bf8b6e9fd4b9c41">More...</a><br /></td></tr>
<tr class="separator:ad71d9c59c88e17c72bf8b6e9fd4b9c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dca872f23051d28a05126a0429321d6"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a5dca872f23051d28a05126a0429321d6">mpu9dof_process</a> (void)</td></tr>
<tr class="memdesc:a5dca872f23051d28a05126a0429321d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process sensor data and calculate roll, pitch, and shake detection. This function processes the sensor data and performs calculations to determine the roll, pitch, and shake detection values. It takes the raw gyro and accelerometer data from rawData and applies necessary conversions to obtain the values in appropriate units. The function converts the raw gyro values to degrees per second by subtracting the gyro offset values and dividing by 131.0. Similarly, the raw accelerometer values are converted to G's by dividing them by 4096.0. The roll and pitch angles are calculated from the accelerometer data using the atan2f function and then converted to degrees by multiplying with the RAD_TO_DEG constant. The complementary filter is applied to combine the gyro and accelerometer data for the roll and pitch angles. The filtered roll and pitch values are updated in processedData using the COMPLEMENTARY_RATIO and DELTA_TIME constants. The shake detection is performed by calculating the magnitude of the accelerometer readings and comparing it to the SHAKE_THRESHOLD. If the magnitude exceeds the threshold, shake is considered to be detected, and the processedData.shake value is set to 0; otherwise, it is set to 1. The function returns a pointer to the processedData structure containing the calculated roll, pitch, and shake values.  <a href="mpu9dof_8h.html#a5dca872f23051d28a05126a0429321d6">More...</a><br /></td></tr>
<tr class="separator:a5dca872f23051d28a05126a0429321d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5433079579490b97f6094c3659af0089"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a5433079579490b97f6094c3659af0089">mpu9dof_log_data</a> (const uint8_t *data)</td></tr>
<tr class="memdesc:a5433079579490b97f6094c3659af0089"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log data based on the specified type.  <a href="mpu9dof_8h.html#a5433079579490b97f6094c3659af0089">More...</a><br /></td></tr>
<tr class="separator:a5433079579490b97f6094c3659af0089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19362190b7708f09cf198ac33319d513"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a19362190b7708f09cf198ac33319d513">mpu9dof_generic_write</a> (const uint8_t *reg, const uint8_t *data_buf, const uint8_t *len)</td></tr>
<tr class="memdesc:a19362190b7708f09cf198ac33319d513"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic write function for MPU9DOF module.  <a href="mpu9dof_8h.html#a19362190b7708f09cf198ac33319d513">More...</a><br /></td></tr>
<tr class="separator:a19362190b7708f09cf198ac33319d513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01269a22d6a6e761803b82be318f568e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mpu9dof_8h.html#a01269a22d6a6e761803b82be318f568e">mpu9dof_generic_read</a> (const uint8_t *reg, uint8_t *data_buf, const uint8_t *len)</td></tr>
<tr class="memdesc:a01269a22d6a6e761803b82be318f568e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic read function for MPU9DOF module. This function is used to read data from the MPU9DOF module. It accepts a register address specified by the reg parameter, a data buffer specified by the data_buf parameter, and the length of the data buffer specified by the len parameter. The function begins by acquiring a critical section to ensure exclusive access to shared resources. It then calls the HAL_I2C_Mem_Read function to read data from the MPU9DOF module. The function specifies the I2C interface (hi2c1), the I2C device address obtained by left-shifting MPU9DOF_XLG_I2C_ADDR_1 by 1, the register address (*reg), the size of the register address (I2C_MEMADD_SIZE_8BIT), the data buffer to store the read data (data_buf), the length of the data to be read (*len), and the maximum delay for the operation (HAL_MAX_DELAY). Finally, the function releases the critical section and returns.  <a href="mpu9dof_8h.html#a01269a22d6a6e761803b82be318f568e">More...</a><br /></td></tr>
<tr class="separator:a01269a22d6a6e761803b82be318f568e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9142720b7540c091b60f8994f33e6ec2" name="a9142720b7540c091b60f8994f33e6ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9142720b7540c091b60f8994f33e6ec2">&#9670;&#160;</a></span>calibrateRawValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrateRawValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad71d9c59c88e17c72bf8b6e9fd4b9c41" name="ad71d9c59c88e17c72bf8b6e9fd4b9c41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad71d9c59c88e17c72bf8b6e9fd4b9c41">&#9670;&#160;</a></span>mpu9dof_calibrate_module()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_calibrate_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrates the 9DOF MPU module by calculating the value of the sample data. This function performs calibration for the 9DOF MPU module. The calibration process is performed by reading gyro data using the <a class="el" href="mpu9dof_8c.html#abc02bdc34e18dabb24af73d49310a0df" title="Read sensor data from MPU9DOF module.">mpu9dof_read()</a> function with the sensor type set to GYRO. The sample data is accumulated in the gyro_sum array. After collecting the required number of samples defined by CALIBRATION_SAMPLES, the mean value is calculated for each gyro axis. The gyro offset values are stored in the offsetValues.gyro_offset array, and the calibrated gyro data is stored in the calibratedData.gyro_calib array. Additionally, a normal 1G offset of the accelerometer in the Z-axis is accounted for by subtracting 16384 from the offsetValues.acc_offset[2] value. The calibrated accelerometer data is stored in the calibratedData.acc_calib[2] variable. </p>
<dl class="section note"><dt>Note</dt><dd>The calibration process assumes that the sensor is at a stable and neutral position during calibration. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mpu9dof_8c.html#abc02bdc34e18dabb24af73d49310a0df" title="Read sensor data from MPU9DOF module.">mpu9dof_read()</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a1159e4f53de21839e7731629ab36c2d6" title="Specifies the number of example values to be recorded for calibration. This constant variable determi...">CALIBRATION_SAMPLES</a> </dd>
<dd>
<a class="el" href="nucleo-l432kc__9dof-imu-click_2_core_2_src_2freertos_8c.html#ac2203bf8f6dd5851eca6112dea4f7b1b">GYRO</a> </dd>
<dd>
gyro_sum </dd>
<dd>
offsetValues.gyro_offset </dd>
<dd>
calibratedData.gyro_calib </dd>
<dd>
offsetValues.acc_offset </dd>
<dd>
calibratedData.acc_calib </dd></dl>
<p >Apply a normal 1G offset correction to the Z-axis accelerometer data.</p>

</div>
</div>
<a id="a949f4308c28a7a773584c8e6c281e3cb" name="a949f4308c28a7a773584c8e6c281e3cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a949f4308c28a7a773584c8e6c281e3cb">&#9670;&#160;</a></span>mpu9dof_default_cfg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_default_cfg </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: </dd></dl>
<p >Chip reset: Resets the chip and adds a 10ms delay.</p>
<p >Initialize accel &amp; gyro: Sets the sample rate divider to default value and adds a 10ms delay.</p>
<p >Disable FIFOs: Disables the FIFO feature and adds a 10ms delay.</p>
<p >Bypass mode enabled: Enables the bypass mode by setting the appropriate configuration in the INT_PIN_CFG register. Adds a 10ms delay.</p>
<p >Disable all interrupts: Disables all interrupts by writing the default value to the INT_ENABLE register. Adds a 10ms delay.</p>
<p >No FIFO and no I2C slaves: Disables the FIFO and I2C slave features by setting the default value in the USER_CTRL register. Adds a 10ms delay.</p>
<p >No power management, internal clock source: Disables power management and sets the internal clock source by writing the default value to the PWR_MGMT_1 register. Adds a 10ms delay.</p>

</div>
</div>
<a id="a01269a22d6a6e761803b82be318f568e" name="a01269a22d6a6e761803b82be318f568e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01269a22d6a6e761803b82be318f568e">&#9670;&#160;</a></span>mpu9dof_generic_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_generic_read </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic read function for MPU9DOF module. This function is used to read data from the MPU9DOF module. It accepts a register address specified by the reg parameter, a data buffer specified by the data_buf parameter, and the length of the data buffer specified by the len parameter. The function begins by acquiring a critical section to ensure exclusive access to shared resources. It then calls the HAL_I2C_Mem_Read function to read data from the MPU9DOF module. The function specifies the I2C interface (hi2c1), the I2C device address obtained by left-shifting MPU9DOF_XLG_I2C_ADDR_1 by 1, the register address (*reg), the size of the register address (I2C_MEMADD_SIZE_8BIT), the data buffer to store the read data (data_buf), the length of the data to be read (*len), and the maximum delay for the operation (HAL_MAX_DELAY). Finally, the function releases the critical section and returns. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reg</td><td>Pointer to the register address. </td></tr>
    <tr><td class="paramname">data_buf</td><td>Pointer to the data buffer to store the read data. </td></tr>
    <tr><td class="paramname">len</td><td>Pointer to the length of the data buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___i2_c___exported___functions___group2.html#ga7b593a1b85bd989dd002ee209eae4ad2">HAL_I2C_Mem_Read</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#ace92afad010308cb88a74c110408833a">MPU9DOF_XLG_I2C_ADDR_1</a> </dd></dl>

</div>
</div>
<a id="a19362190b7708f09cf198ac33319d513" name="a19362190b7708f09cf198ac33319d513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19362190b7708f09cf198ac33319d513">&#9670;&#160;</a></span>mpu9dof_generic_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_generic_write </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic write function for MPU9DOF module. </p>
<p >This function is used to write data to the MPU9DOF module. It accepts a register address specified by the reg parameter, a data buffer specified by the data_buf parameter and the length of the data buffer specified by the len parameter. The function begins by acquiring a critical section to ensure exclusive access to shared resources. It then constructs a data array with the register address as the first element and copies the data from the data buffer into the remaining elements using the memcpy function. The function then calls the HAL_I2C_Master_Transmit function to transmit the data array over the I2C interface to the MPU9DOF module. The I2C address used for transmission is obtained by left-shifting the constant MPU9DOF_XLG_I2C_ADDR_1 by 1.</p>
<p >Finally, the function releases the critical section and returns.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reg</td><td>Pointer to the register address. </td></tr>
    <tr><td class="paramname">data_buf</td><td>Pointer to the data buffer. </td></tr>
    <tr><td class="paramname">len</td><td>Pointer to the length of the data buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group___i2_c___exported___functions___group2.html#ga9440a306e25c7bd038cfa8619ec9a830">HAL_I2C_Master_Transmit</a> </dd>
<dd>
memcpy </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#ace92afad010308cb88a74c110408833a">MPU9DOF_XLG_I2C_ADDR_1</a> </dd></dl>

</div>
</div>
<a id="a5433079579490b97f6094c3659af0089" name="a5433079579490b97f6094c3659af0089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5433079579490b97f6094c3659af0089">&#9670;&#160;</a></span>mpu9dof_log_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_log_data </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log data based on the specified type. </p>
<p >This function logs different types of data based on the value of *data. The function accepts a pointer to the data variable, which is used in a switch statement to determine the type of data to log. If *data is 1, the function logs the raw accelerometer and gyroscope data by printing the values of rawData.acc and rawData.gyro using the printf function. If *data is 2, the function logs the calibration offset for the gyroscope by printing the values of offsetValues.gyro_offset using the printf function. If *data is 3, the function logs the calibrated data. (TODO: Add details if available.) If *data is 4, the function logs the processed final data, including the roll, pitch, and shake values from processedData, using the printf function.</p>
<p >If none of the above cases match, indicating an invalid value for *data, an error message is printed using the printf function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Pointer to the data type specifier. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>rawData.acc </dd>
<dd>
rawData.gyro </dd>
<dd>
offsetValues.gyro_offset </dd>
<dd>
processedData.roll </dd>
<dd>
processedData.pitch </dd>
<dd>
processedData.shake </dd></dl>

</div>
</div>
<a id="a5dca872f23051d28a05126a0429321d6" name="a5dca872f23051d28a05126a0429321d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dca872f23051d28a05126a0429321d6">&#9670;&#160;</a></span>mpu9dof_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * mpu9dof_process </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process sensor data and calculate roll, pitch, and shake detection. This function processes the sensor data and performs calculations to determine the roll, pitch, and shake detection values. It takes the raw gyro and accelerometer data from rawData and applies necessary conversions to obtain the values in appropriate units. The function converts the raw gyro values to degrees per second by subtracting the gyro offset values and dividing by 131.0. Similarly, the raw accelerometer values are converted to G's by dividing them by 4096.0. The roll and pitch angles are calculated from the accelerometer data using the atan2f function and then converted to degrees by multiplying with the RAD_TO_DEG constant. The complementary filter is applied to combine the gyro and accelerometer data for the roll and pitch angles. The filtered roll and pitch values are updated in processedData using the COMPLEMENTARY_RATIO and DELTA_TIME constants. The shake detection is performed by calculating the magnitude of the accelerometer readings and comparing it to the SHAKE_THRESHOLD. If the magnitude exceeds the threshold, shake is considered to be detected, and the processedData.shake value is set to 0; otherwise, it is set to 1. The function returns a pointer to the processedData structure containing the calculated roll, pitch, and shake values. </p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the processedData structure. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>rawData.gyro </dd>
<dd>
offsetValues.gyro_offset </dd>
<dd>
rawData.acc </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#aa13aa37077c3b71dfcadf38e1bc7bfe4">COMPLEMENTARY_RATIO</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#ad41d7e66c90529c1f3d8e8be9df8ed95">DELTA_TIME</a> </dd>
<dd>
processedData.roll </dd>
<dd>
processedData.pitch </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a3e92e8253a6240e36fc8ed496aec2a03" title="Constants for motion sensing. These constants define various parameters used in motion sensing calcul...">SHAKE_THRESHOLD</a> </dd>
<dd>
processedData.shake </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a374e8373687339ac309e4f02b305fb0f">RAD_TO_DEG</a> </dd></dl>

</div>
</div>
<a id="abc02bdc34e18dabb24af73d49310a0df" name="abc02bdc34e18dabb24af73d49310a0df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc02bdc34e18dabb24af73d49310a0df">&#9670;&#160;</a></span>mpu9dof_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpu9dof_read </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>sensor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read sensor data from MPU9DOF module. </p>
<p >This function reads sensor data from the MPU9DOF module based on the provided sensor type. The sensor type is specified using the parameter sensor. If sensor is equal to 1, the function reads gyro data from the module's registers, including X, Y, and Z-axis gyro values, and stores them in the rawData.gyro array. If sensor is equal to 2, the function reads accelerometer data from the module's registers, including X, Y, and Z-axis accelerometer values, and stores them in the rawData.acc array. If sensor is neither 1 nor 2, an error message is printed. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor</td><td>Sensor type to read data from. Valid values are 1 (gyro) and 2 (accelerometer).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="mpu9dof_8c.html#a01269a22d6a6e761803b82be318f568e" title="Generic read function for MPU9DOF module. This function is used to read data from the MPU9DOF module....">mpu9dof_generic_read()</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#aa003a2decca0e11c619289f80f9d33ff" title="High registers of the gyroscope and accelerometer. These constants define the addresses of the high r...">MPU9DOF_GYRO_XOUT_H</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#aa0f9f5d494a3ccc3c87c8fb88ae287dd">MPU9DOF_GYRO_YOUT_H</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a05da3d1b8555e6647aa4bcb108cd47f1">MPU9DOF_GYRO_ZOUT_H</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a5ee7c56be6f5ccd8c9fc46bd8f64fe1d">MPU9DOF_ACCEL_XOUT_H</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#af3ab19293e1923b48e195a2cba1bdb0e">MPU9DOF_ACCEL_YOUT_H</a> </dd>
<dd>
<a class="el" href="mpu9dof_8c.html#a323047f22c2674ae3ea96f2c4f8d331d">MPU9DOF_ACCEL_ZOUT_H</a> </dd>
<dd>
rawData.gyro </dd>
<dd>
rawData.acc </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
