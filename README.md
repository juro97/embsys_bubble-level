# Projekt Wasserwaage
Im Rahmen der Lehrveranstaltung Embedded Systems BIC-3 an der FH Technikum, wurde als Abschlussarbeit eine digitale Wasserwaage ausgewählt.
Diese soll die Neigungsdaten über einen geeigneten Sensor einlesen, verarbeiten und per WiFi an einen WebServer weiterleiten. Dieser Webserver agiert als Broker zwischen Sensor und Aktor und sendet die empfangenen Daten per WiFi weiter an eine 4x4 RGB LED Matrix und einen Piezo-Beeper.

# Projektmitglieder
- Thomas Galler
- Paul Jurassovits
- Schahnaz-Isabel Westenberger
- Melchior Lebesmühlbacer

## Orderstruktur
|
|-DokuXXX
|-Source
  |- Nucleo-4x4
  |- Nucleo-3DMotion
  |- Nucleo-Beeper
  |- RaspberryPi
  |- Tests

## How-To-Start
1. Power on the Raspberry Pi: 
Plug in the Raspberry Pi and wait for it to boot up. 
The wireless access point should automatically become available after the auto-boot process completes, usually within 30 to 60 seconds.

2. Connect Click modules to the access point: 
Ensure that the Click modules you want to use are connected to the Raspberry Pi's wireless access point. 
The Click modules are now able to communicate with the Raspberry Pi through the access point.

3. Access the Blazor web server: 
The .NET Blazor web server is running on the Raspberry Pi at IP address 192.168.178.82 and port 4300. 
Open a web browser on a device connected to the same network and enter the following address: http://192.168.178.82:4300.

### Piezo-Beeper
The STM32 with this implementation uses 4 Tasks of FreeRTOS to fetch values via UART, either generated by the Wifi-Click or by a User-command on a Monitor. If the value comes from the Wifi-Click, the value will be written into a global variable rx_wifi. Otherwise, when a user enters a value, the value will be written into the global variable rx_uart. Those two variables, rx_wifi and rx_uart are used as comparison values in a switch-case block of t1_Buzzer task and t4_Wifi_Listener task, accordingly. If the switch-case matches a value, the function f4_set_TIM_Register() will be called which sets the Auto-Reload Register and the Captcher-Compare Register of the set Timer according to a predefined value rx_x. If any value out of the spectrum was written into rx_wifi or rx_uart the switch-case will silence the Piezo-Beeper by setting the Timer Registers to 0.

#### Global variables
* rx_wifi - receives value (hopefully) a-s from the Wifi-Click
* rx_uart - receives value (hopefully) a-s from a User-Monitor
* rx_x - where x stands for a-s are constant values to set the Timer Registers

#### Tasks
* t1_Buzzer - starts the PWM and calls f4_set_TIM_Register()
* t2_Listener - checks for received values from the User-Monitor and writes the value into rx_uart
* t3_Wifi_Listener - calls the f4_set_TIM_Register() 
* t4_Wifi_Starter - starts the Wifi-Click

#### Functions
* f4_set_TIM_Register() - is called with rx_x as parameter and sets the Timer Registers ARR and CCR
* f4_send_UART() - sends back the entered value to the User-Monitor
